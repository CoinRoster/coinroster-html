<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>CoinRoster | Daily Fantasy Sports | Bitcoin</title>
    <meta name="description" content="CoinRoster offers Daily Fantasy Sports for Bitcoin! Join a contest, create a roster, and win!" />
    <meta name="keywords" content="coinroster, bitcoin, daily fantasy sports, dfs, fantasy sports" />
    <meta name="Robots" content="index,follow,NOODP" />  
    <meta name="googlebot" content="NOODP" />        
    <meta name="rating" content="General" />
    <!--#include virtual="/ssi/head.html" -->
    <link rel="stylesheet" type="text/css" href="/css/lobby.css">
    <script type="text/javascript" src="/js/lobby.js"></script>
</head>
<body>
<!--#include virtual="/ssi-java/nav" -->
<!--#include virtual="/ssi/simple_modal.html" -->
<div id="centering_container">
    <div id="body_container">
        <br/>
        <h3 id="category_header" class="section_header">
            <span id="category_text"></span><span id="sub_category_text"></span>
        </h3>
        <div id="no_data_message"></div>
    </div>
    <div class="table_body_container">
        <table id="category_report_table" class="contest_table"></table>
    </div>
</div>
<script type="text/javascript">

    function init()
        {
        var 

        category = get_url_param("main"),
        sub_category = get_url_param("sub");

        if (category === null ||sub_category === null) return special_no_data_message();

        id("ssi_header_lobby").className = "ssi_header_a";
        
        api({ 
            method: "ContestReport", 
            args: {
                category: category,
                sub_category: sub_category
            } 
        }, function(call)
            {
            var
            
            category_description = call.category_description,
            sub_category_description = call.sub_category_description;
    
            if (typeof category_description === "undefined" || typeof sub_category_description === "undefined") return special_no_data_message();

            id("ssi_mobile_nav_placeholder").innerHTML = category_description;
            id("category_text").innerHTML = category_description + "&nbsp;&nbsp;-&nbsp;&nbsp;";
            id("sub_category_text").innerHTML = sub_category_description;

            var 
            
            table = id("category_report_table"),
            contest_report = call.contest_report,
            number_of_contests = contest_report.length;
    
            if (number_of_contests === 0) 
                {
                id("no_data_message").innerHTML = [
                    "There are no open contests in this category. Please check back soon.",
                    "<a href='/' class='inline_link'>Return to lobby</a>"
                ].join("<br/></br></br>");
                }
            else
                {
                var header = new_row(table, -1, [
                    "Contest",
                    "Deadline",
                    "Game type",
                    "Entry fee",
                    "Prize pool"
                ]);
                
                header[4].className = "right_nowrap";
                header[5].className = "right_nowrap";
                    
                for (var i=0; i<number_of_contests; i++)
                    {
                    var contest_item = contest_report[i],

                    contest_id = contest_item.id,
                    title = contest_item.title,
                    settlement_type = contest_item.settlement_type,
                    pay_table = contest_item.pay_table,
                    cost_per_entry = contest_item.cost_per_entry,
                    total_prize_pool = contest_item.total_prize_pool,
                    registration_deadline_string = get_registration_deadline_string(contest_item.registration_deadline),
                    status = contest_item.status,
                    status_string,
                    button_string,
                    button_class = "";
            
                    switch (status)
                        {
                        case 1:
                            button_string = "Enter";
                            status_string = "Reg open";
                            button_class = "orange orange_border";
                            break;
                        case 2:
                            button_string = "View";
                            status_string = "In play";
                            registration_deadline_string = "In play";
                            break;
                        }
                        
                    var 
                    
                    enter_button = "<a class=\"contest_table_link " + button_class + "\" style=\"float:right;width:auto;\" href='/contest.html?id=" + contest_id + "'>" + button_string + "</button>",
                    game_type = "<span style=\"white-space:nowrap\">" + settlement_type_string(settlement_type) + "</span><span id=\"payout_info_" + contest_id + "\" class=\"payout_info_link teal\">Payout info</span>",
                     
                    row = new_row(table, -1, [
                        "<ul><li>" + title + "</li><li>" + enter_button + "</li></ul>",
                        "<div class='field_label'>Deadline:</div>" + registration_deadline_string,
                        "<div class='field_label'>Game type:</div>" + game_type,
                        "<div class='field_label'>Entry fee:</div>" + toBTC(cost_per_entry) + " BTC",
                        "<div class='field_label'>Prize pool:</div>" + toBTC(total_prize_pool) + " BTC"
                    ]);

                    row[4].className = "right_nowrap";
                    row[5].className = "right_nowrap";

                    bind_payout_window(id("payout_info_" + contest_id), settlement_type, pay_table);
                    }
                }
            });
        }
        
    function special_no_data_message()
        {
        id("category_text").innerHTML = "Invalid category";
        id("no_data_message").innerHTML = "<a href='/' class='inline_link'>Return to lobby</a>";
        }

</script>
<script type="text/javascript" src="/js/nav.js"></script>
<!--#include virtual="/ssi/google_analytics.html" -->
</body>
</html>
