<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>CoinRoster | Daily Fantasy Sports | Bitcoin</title>
    <!--#include virtual="/ssi/head.html" -->
    <link rel="stylesheet" type="text/css" href="/css/account.css">
    <script type="text/javascript" src="/js/account.js"></script>
</head>
<body>
<!--#include virtual="/ssi/nav.html" -->
<!--#include virtual="/ssi/simple_modal.html" -->
<div id="centering_container">
    <div id="body_container">
        <div id="initial_container">
            <div id="page_title">
                Deposit BTC
            </div>
            <br/>
            <span class="orange">
                You must initiate deposits from your Bitcoin wallet
            </span>
            <br/>
            <br/>
            <div class="input_padding description_text">
                Please use the form below to tell us how much you intend to deposit.
                <br/>
                <br/>
                We will credit your account within 24 hours of receiving the funds.
            </div>
            <br/>
            <br/>
            <span class="orange">
                Transfer instructions
            </span>
            <br/>
            <br/>
            <div class="input_padding description_text">
                Please transfer funds from your connected wallet:
                <br/>
                <br/>
                <span id="user_ext_address" class="blue"></span>
                <br/>
                <br/>
                To our public wallet:
                <br/>
                <br/>
                <span id="cash_register_address" class="blue"></span>
            </div>
            <br/>
            <br/>
            <span class="orange">
                How much would you like to deposit?
            </span>
            <br/>
            <br/>
            <div class="input_padding description_text">
                <form onsubmit="return submit_pending_deposit();">
                    <input placeholder="Amount to deposit" label="false" id="amount_to_deposit" type="text" btc-input="true" class="input_style" autocorrect="off" autocapitalize="off" spellcheck="false">
                    <div class="add_left_margin" style="display:inline-block">
                        BTC
                    </div>
                    <br/>
                    <br/>
                    <button class="text_button" type="submit">Continue</button>
                </form>
            </div>
        </div>
        <div id="confirmation_container" style="display:none">
            <div id="page_title">
                Deposit BTC
            </div>
            <br/>
            <span class="orange">
                Please initiate a deposit from your wallet
                <br/>
                <br/>
                We will credit your account as soon as the funds arrive
            </span>
            <br/>
            <br/>
            <div class="input_padding description_text">
                Deposit amount:
                <br/>
                <br/>
                <br/>
                <h2 id="amount_to_deposit_confirm" class="lucida"></h2><br/>
                <br/>
                From:
                <br/>
                <br/>
                <span id="user_ext_address_confirm" class="blue"></span>
                <br/>
                <br/>
                <br/>
                To:
                <br/>
                <br/>
                <span id="cash_register_address_confirm" class="blue"></span>
                <br/>
                <br/>
                <br/>
                <a class="text_button a_button" href="/account" style="color:white">Back to account</a>
            </div>
        </div>
    </div>
</div>
<script type="text/javascript" src="/js/btc_inputs.js"></script>
<script type="text/javascript">

    var focus_to_input = function()
        {
        id("amount_to_deposit").focus();
        };
        
    focus_to_input();

    var
    
    user_ext_address = get_ext_address(true),
    cash_register_address = get_ext_address(false);
    
    id("user_ext_address").innerHTML = user_ext_address;
    id("user_ext_address_confirm").innerHTML = user_ext_address;
    id("cash_register_address").innerHTML = cash_register_address;
    id("cash_register_address_confirm").innerHTML = cash_register_address;
    
    function submit_pending_deposit()
        {
        var amount_to_deposit = id("amount_to_deposit").value;

        if (amount_to_deposit === "") 
            {
            show_simple_modal("Please enter an amount to deposit", "good", focus_to_input);
            return false;
            }
            
        if (parseFloat(amount_to_deposit) === 0.0) 
            {
            show_simple_modal("Cannot deposit 0.0000000", "bad", focus_to_input);
            return false;
            }

        api({ 
            method: "UserDeposit", 
            args: {
                amount_to_deposit: amount_to_deposit,
                user_ext_address: user_ext_address,
                cash_register_address: cash_register_address
            } 
        }, function(call)
            {
            if (call.status === "1")
                {
                id("amount_to_deposit_confirm").innerHTML = amount_to_deposit + " BTC";
                hide("initial_container");
                show("confirmation_container");
                }
            else show_simple_modal(call.error, "bad", null);
            });
        
        return false;
        }
</script>
</body>
</html>
